const nodePromise = require('node-promise');
const crypto = require('crypto');

module.exports = {
  sha256,
  hash
};

function hash(secret, salt) {
  return nodePromise(cb => crypto.pbkdf2(secret, process.env.SECRET + salt, 100000, 512, 'sha512', cb))
    .then(key => key.toString('hex'));
}

function sha256(message) {
  return crypto.createHmac('sha256', process.env.SECRET + message)
    .update(message)
    .digest('hex');
}