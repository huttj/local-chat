const assert = require('assert');
const redis = require('shared-redis');

module.exports = function(userId, sessionKey) {
  "use strict";
  if (!userId || !sessionKey) {
    return Promise.reject('userId or sessionKey not provided');
  }
  return redis.get(userId)
    .then(savedSessionKey => {
      assert(savedSessionKey && savedSessionKey === sessionKey, 'userId or sessionKey do not match');
      return 'you have been authenticated';
    });
};